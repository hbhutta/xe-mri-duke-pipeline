/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/ml_collections/config_flags/config_flags.py:19: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
2025-06-18 16:44:04.356225: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-18 16:44:04.765922: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/cv2/../../lib64:
2025-06-18 16:44:04.765970: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2025-06-18 16:44:04.825174: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-18 16:44:05.746974: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/cv2/../../lib64:
2025-06-18 16:44:05.747083: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/cv2/../../lib64:
2025-06-18 16:44:05.747096: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
WARNING:tensorflow:From /home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:107: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/keras/optimizers/optimizer_v2/adam.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)
/data/Haad/xe-mri-rachel/xenon-gas-exchange-consortium-main_james_version/utils/metrics.py:4: DeprecationWarning: Please use `binary_dilation` from the `scipy.ndimage` namespace, the `scipy.ndimage.morphology` namespace is deprecated.
  from scipy.ndimage.morphology import binary_dilation
2025-06-18 16:44:06.657623: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/cv2/../../lib64:
2025-06-18 16:44:06.657933: W tensorflow/stream_executor/cuda/cuda_driver.cc:263] failed call to cuInit: UNKNOWN ERROR (303)
2025-06-18 16:44:06.657957: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (epyc02): /proc/driver/nvidia/version does not exist
I0618 16:44:06.658134 140333630408512 subject_classmap.py:74] Initializing gas exchange imaging subject.
split_mask received file path: cohort/PIm0025/CT_lobe_mask_neg_affine.nii
Making Nifti1Image objects out of splits data
File already exists: cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
File already exists: cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_16.nii
File already exists: cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_32.nii
File already exists: cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_64.nii
File already exists: cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_128.nii
split_mask received file path: cohort/PIm0025/ct_corepeel_mask_neg_affine_mod_x_y_z.nii
Making Nifti1Image objects out of splits data
File already exists: cohort/PIm0025/ct_corepeel_mask_neg_affine_mod_x_y_z_split_PI_40.nii
File already exists: cohort/PIm0025/ct_corepeel_mask_neg_affine_mod_x_y_z_split_PI_50.nii
Processing split cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Reading #1 from cohort/PIm0025/mask_vent_mutated_affine_resized_warped.nii
Reading #2 from cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Multiplying #2 and #1
Writing #1 to file cohort/PIm0025/mask_vent_mutated_affine_resized_warped__CT_lobe_mask_neg_affine_split_PI_8_product.nii
  Output voxel type: float[f]
  Rounding off: Disabled
stats.py: Set subject.mask_vent to its intersection with the current split (cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii)
Reading #1 from cohort/PIm0025/image_gas_binned_mutated_affine_resized_warped.nii
Reading #2 from cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Multiplying #2 and #1
Writing #1 to file cohort/PIm0025/image_gas_binned_mutated_affine_resized_warped__CT_lobe_mask_neg_affine_split_PI_8_product.nii
  Output voxel type: float[f]
  Rounding off: Disabled
stats.py: Set subject.image_gas_binned to its intersection with the current split (cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii)
Reading #1 from cohort/PIm0025/image_rbc2gas_binned_mutated_affine_resized_warped.nii
Reading #2 from cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Multiplying #2 and #1
Writing #1 to file cohort/PIm0025/image_rbc2gas_binned_mutated_affine_resized_warped__CT_lobe_mask_neg_affine_split_PI_8_product.nii
  Output voxel type: float[f]
  Rounding off: Disabled
stats.py: Set subject.image_rbc2gas_binned to its intersection with the current split (cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii)
Reading #1 from cohort/PIm0025/image_rbc2gas_mutated_affine_resized_warped.nii
Reading #2 from cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Multiplying #2 and #1
Writing #1 to file cohort/PIm0025/image_rbc2gas_mutated_affine_resized_warped__CT_lobe_mask_neg_affine_split_PI_8_product.nii
  Output voxel type: float[f]
  Rounding off: Disabled
stats.py: Set subject.image_rbc2gas to its intersection with the current split (cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii)
Reading #1 from cohort/PIm0025/image_membrane2gas_binned_mutated_affine_resized_warped.nii
Reading #2 from cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Multiplying #2 and #1
Writing #1 to file cohort/PIm0025/image_membrane2gas_binned_mutated_affine_resized_warped__CT_lobe_mask_neg_affine_split_PI_8_product.nii
  Output voxel type: float[f]
  Rounding off: Disabled
stats.py: Set subject.image_membrane2gas_binned to its intersection with the current split (cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii)
Reading #1 from cohort/PIm0025/image_membrane2gas_mutated_affine_resized_warped.nii
Reading #2 from cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii
Multiplying #2 and #1
Writing #1 to file cohort/PIm0025/image_membrane2gas_mutated_affine_resized_warped__CT_lobe_mask_neg_affine_split_PI_8_product.nii
  Output voxel type: float[f]
  Rounding off: Disabled
stats.py: Set subject.image_membrane2gas to its intersection with the current split (cohort/PIm0025/CT_lobe_mask_neg_affine_split_PI_8.nii)
computing bin_percentage
bin_percentage(): volume_in_bins = 0
bin_percentage(): mask_volume = 2214028
computing bin_percentage
bin_percentage(): volume_in_bins = 0
bin_percentage(): mask_volume = 2214028
computing bin_percentage
bin_percentage(): volume_in_bins = 0
bin_percentage(): mask_volume = 2214028
Traceback (most recent call last):
  File "stats.py", line 318, in <module>
    app.run(main)
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "stats.py", line 310, in main
    compute_patient_stats(config)
  File "stats.py", line 279, in compute_patient_stats
    subject.get_statistics()
  File "/data/Haad/xe-mri-rachel/xenon-gas-exchange-consortium-main_james_version/subject_classmap.py", line 600, in get_statistics
    img_utils.normalize(np.abs(self.image_gas_cor), self.mask, constants.NormalizationMethods.PERCENTILE_MASKED), self.mask
  File "/data/Haad/xe-mri-rachel/xenon-gas-exchange-consortium-main_james_version/utils/img_utils.py", line 216, in normalize
    return image_n.compute()
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/dask/base.py", line 314, in compute
    (result,) = compute(self, traverse=False, **kwargs)
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/dask/base.py", line 599, in compute
    results = schedule(dsk, keys, **kwargs)
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/dask/threaded.py", line 89, in get
    results = get_async(
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/dask/local.py", line 514, in get_async
    finish_task(dsk, key, state, results, keyorder.get)
  File "/home/hbhutta/miniconda3/envs/xe-mri/lib/python3.8/site-packages/dask/local.py", line 278, in finish_task
    release_data(dep, state, delete=delete)
KeyboardInterrupt
